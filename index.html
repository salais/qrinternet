<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>

<script>
    // Configuración de Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyD1UePxM4Mi33Z106b0NZSDsXTLlmxlkOo",
        authDomain: "itos-f1e25.firebaseapp.com",
        projectId: "itos-f1e25",
        storageBucket: "itos-f1e25.appspot.com",
        messagingSenderId: "910377107049",
        appId: "1:910377107049:web:f6007fa49e5487da986cf8",
        measurementId: "G-JCC8TR2VDT"
    };

    firebase.initializeApp(firebaseConfig);
    const storage = firebase.storage();

    let countdown = 15;
    let slideIndex = 0;
    let images = [];

    // Cargar imágenes desde Firebase Storage
    async function loadAds() {
        try {
            console.time("Carga de imágenes desde Storage");
            const storageRef = storage.ref("ads"); // Carpeta "ads" en Storage
            const files = await storageRef.listAll();
            console.timeEnd("Carga de imágenes desde Storage");

            images = await Promise.all(files.items.map(async (fileRef) => {
                const url = await fileRef.getDownloadURL();
                return { url };
            }));

            console.log("Imágenes cargadas desde Storage:", images);

            if (images.length > 0) {
                showSlides();
            } else {
                console.error("No hay imágenes disponibles.");
            }
        } catch (error) {
            console.error("Error al cargar las imágenes:", error);
        }
    }

    function showSlides() {
        if (images.length === 0) {
            console.error("No hay imágenes disponibles.");
            return;
        }

        let slideshow = document.getElementById("slideshow");

        let currentImage = images[slideIndex].url;
        slideshow.src = currentImage + "?t=" + new Date().getTime();

        console.log("Mostrando imagen:", currentImage);

        slideIndex = (slideIndex + 1) % images.length;

        setTimeout(showSlides, 5000);
    }

    window.onload = function() {
        updateCountdown();
        loadAds();
    };
</script>
